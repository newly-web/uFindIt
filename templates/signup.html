{% extends "layout.html" %}
<!-- Add CSS -->
{% block content %}
<div class="content container mt-5">
    <form action="" method="POST" novalidate>
        {{ form.hidden_tag() }}

        <!-- Username Field -->
        <div class="form-group mb-3">
            <label for="username">{{ form.username.label }}</label>
            
            {% if form.username.errors %}
            {{ form.username(class="form-control is-invalid", id="username") }}
            <div class="invalid-feedback" id="username-error">
                {% for error in form.username.errors %}
                <span class="mb-0">{{ error }}</span>
                {% endfor %}
            </div>
            {% else %}
                {{ form.username(class="form-control", id="username") }}
            {% endif %}
        </div>

        <!-- Student Number Field -->
        <div class="form-group mb-3">
            <label for="student_number">{{ form.student_number.label }}</label>
            {% if form.student_number.errors %}
            {{ form.student_number(class="form-control is-invalid", id="student_number", oninput="this.value =
            this.value.replace(/[^0-9]/g, '')") }}
            <div class="invalid-feedback" id="student-number-error">
                {% for error in form.student_number.errors %}
                <span class="mb-0">{{ error }}</span>
                {% endfor %}
            </div>
            {% else %}
            {{ form.student_number(class="form-control", id="student_number", oninput="this.value =
            this.value.replace(/[^0-9]/g, '')") }}
            {% endif %}
        
        </div>

        <!-- Email Field -->
        <div class="form-group mb-3">
            <label for="email">{{ form.email.label }}</label>
            {% if form.email.errors %}
            {{ form.email(class="form-control is-invalid", id="email") }}
            <div class="invalid-feedback" id="email-error">
                {% for error in form.email.errors %}
                <span class="mb-0">{{ error }}</span>
                {% endfor %}
            </div>
            {% else %}
            {{ form.email(class="form-control", id="email") }}
            {% endif %}
        </div>

        <!-- Password Field -->
        <div class="form-group mb-3">
            <label for="password">{{ form.password.label }}</label>
            
            {% if form.password.errors %}
            {{ form.password(class="form-control is-invalid", id="password") }}
            <div class="invalid-feedback" id="password-error">
                {% for error in form.password.errors %}
                <span class="mb-0">{{ error }}</span>
                {% endfor %}
            </div>
            {%else%}
            {{ form.password(class="form-control", id="password") }}
            {% endif %}
        </div>

        <!-- Submit Button -->
        <div class="form-group text-center">
            {{ form.submit(class="btn btn-primary btn-lg") }}
        </div>
    </form>

    <!-- Link to Login -->
    <div class="text-center mt-3">
        <small class="text-muted">
            Already have an account? <a href="{{ url_for('login') }}">Login here!</a>
        </small>
    </div>
</div>

<!-- Add JavaScript to remove error on input -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Loop through all input fields and add event listeners
        const formFields = document.querySelectorAll('.form-control');

        formFields.forEach(function (field) {
            field.addEventListener('input', function () {
                const errorDiv = field.closest('.form-group').querySelector('.invalid-feedback');
                if (errorDiv) {
                    errorDiv.style.display = 'none';
                }
            });
        });
    });
</script>
{% endblock content %}